<!DOCTYPE html>
<html>
	<head>
		<title>Frame View. List.</title>
		<script src="../coreStreams/Content.js"></script>
		<script src="../coreStreams/Frame.js"></script>
		<script>
			var frame = new Frame();

			function onClickLoadJSON(source)
			{
				var nodeViewContainer = document.getElementById('nodeList');
				nodeViewContainer.innerHTML = '';

				var initNodes;
				try
				{
					initNodes = JSON.parse(source.value).nodes;
				}
				catch (e)
				{
					console.log('Can not parse given content string as JSON. String: ' + source + '; Name: ' + e.name + '; Desc: ' + e.message);
					initNodes = {};
				}

				frame = new Frame(initNodes);
				var frameControl = new FrameControl(frame);

				var matrix = frameControl.getMatrix();
				for (var nodeId in matrix)
				{
					var nodeControl = frameControl.getNodeControl(nodeId);
					var nodeButton = document.createElement('button');
					var caption = '';
					var imax = nodeControl.getAtomsCount();
					for (var i = 0; i < imax; ++i)
					{
						caption += nodeControl.getAtomControl(i).getContent() + '<br>';
					}
					nodeButton.innerHTML = caption;
					nodeViewContainer.appendChild(nodeButton);
					nodeViewContainer.appendChild(document.createElement('br'));
				}
			}

			function onClickSaveJSON(destination)
			{
				var frameControl = new FrameControl(frame);
				destination.value = frameControl.stringify();
			}

			function onClickNewNode(nodeList)
			{
				alert(nodeList);
			}

			function onClickNewAtom(nodeList)
			{
				alert(nodeList);
			}

			function onClickDelNode(nodeList)
			{
				alert(nodeList);
			}

			function onClickDelAtom(nodeList)
			{
				alert(nodeList);
			}

			function onClickRenameAtom(nodeList)
			{
				alert(nodeList);
			}

			function onClickAtomAbstract(nodeList)
			{
				alert(nodeList);
			}

			function onClickAtomConcrete(nodeList)
			{
				alert(nodeList);
			}
		</script>
	</head>
	<body>
		<div id="frameView">
			<div id="commands">
				<button onclick="onClickNewNode(document.getElementById('nodeList'));">new node</button>
				<button onclick="onClickNewAtom(document.getElementById('nodeList'));">new atom</button>
				<button onclick="onClickDelNode(document.getElementById('nodeList'));">del node</button>
				<button onclick="onClickDelAtom(document.getElementById('nodeList'));">del atom</button>
				<button onclick="onClickRenameAtom(document.getElementById('nodeList'));">rename atom</button>
				<button onclick="onClickAtomAbstract(document.getElementById('nodeList'));">atom set abstracts</button>
				<button onclick="onClickAtomConcrete(document.getElementById('nodeList'));">atom set concretes</button>
				;
				<textarea id="loadInput"></textarea>
				<button onclick="onClickLoadJSON(document.getElementById('loadInput'));">load from JSON</button>
				;
				<textarea id="saveOutput"></textarea>
				<button onclick="onClickSaveJSON(document.getElementById('saveOutput'));">save to JSON</button>
			</div>
			<div id="nodeList">
				<button>fkhkvlkvytyb</button><br>
				<button>hgfgfgkvlkvub</button><br>
				<button>xvcbvbvlutykvb</button><br>
				<button>zcxxcxvcvlkiuvb</button><br>
			</div>
		</div>
	</body>
</html>